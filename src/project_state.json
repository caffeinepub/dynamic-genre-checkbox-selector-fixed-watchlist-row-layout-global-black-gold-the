{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 27,
  "summary": "Internet Computer dapp template initialized: Motoko backend with authorization + blob storage, and a React (Vite) frontend implementing Internet Identity login, user profile setup, and a basic Manga library UI with cover image upload and pagination.",
  "existing_features": [
    {
      "id": "IF-1",
      "title": "Internet Identity authentication (login/logout)",
      "synonyms": [
        "II auth",
        "Internet Identity login"
      ],
      "description": "Frontend integrates Internet Identity for user sign-in/sign-out and actor initialization for authenticated calls.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "User profile setup and current-user profile retrieval",
      "synonyms": [
        "profile setup",
        "user profile"
      ],
      "description": "UI dialog for initial profile setup and hooks/utilities to fetch/use the current user's profile.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "Manga library CRUD UI (create + list)",
      "synonyms": [
        "manga list",
        "add manga"
      ],
      "description": "Frontend pages/components to add manga entries and display a list of manga cards.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Cover image upload + storage integration",
      "synonyms": [
        "cover images",
        "blob upload"
      ],
      "description": "Cover image field and storage client wiring to upload/store cover images via blob-storage canister/module.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "Pagination controls for manga listing",
      "synonyms": [
        "paging"
      ],
      "description": "Pagination controls and hooks for fetching manga pages and navigating results.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Motoko backend authorization module and access control",
      "synonyms": [
        "authorization mixin",
        "access control"
      ],
      "description": "Backend includes reusable authorization/access-control modules used to gate operations.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Build/deploy template for IC (backend + frontend)",
      "synonyms": [
        "build template",
        "deploy scripts"
      ],
      "description": "Repository includes build-template assets (Dockerfile, scripts, canister.yaml, configs) for building and deploying the full-stack app.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "feature-update-the-actor-initialization-flow-so-the-frontend-has-an-explicit-reliable-actor-is-ready-state-that-only-becomes-true-after-1-the-actor-instance-is-created-2-access-control-initialization-if-applicable-succeeds-and-3-a-backend-readiness-check-passes-do-not-trigger-dependent-query-refetches-until-this-ready-state-is-true",
      "title": "Update the actor initialization flow so the frontend has an explicit, reliable 'actor is ready' state that only becomes true after: (1) the actor instance is created, (2) access control initialization (if applicable) succeeds, and (3) a backend readiness check passes; do not trigger dependent query refetches until this ready state is true.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-strengthen-retry-backoff-and-error-classification-across-backend-calls-add-defensive-retries-for-transient-connection-replica-errors-ensure-retries-are-bounded-and-ensure-the-ui-clearly-differentiates-between-a-connecting-not-ready-b-connection-failed-and-c-application-level-errors-e-g-unauthorized",
      "title": "Strengthen retry/backoff and error classification across backend calls: add defensive retries for transient connection/replica errors, ensure retries are bounded, and ensure the UI clearly differentiates between (a) connecting/not ready, (b) connection failed, and (c) application-level errors (e.g., Unauthorized).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-add-additional-ui-level-hardening-so-no-user-action-can-trigger-a-backend-call-before-readiness-disable-relevant-buttons-forms-during-connecting-state-show-a-clear-connecting-to-backend-state-where-appropriate-and-prevent-double-submit-or-repeated-retries-from-spamming-calls",
      "title": "Add additional UI-level hardening so no user action can trigger a backend call before readiness: disable relevant buttons/forms during connecting state, show a clear 'connecting to backend' state where appropriate, and prevent double-submit or repeated retries from spamming calls.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Add dynamic genre checkbox list sourced from existing genres (in addition to manual entry)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Watchlist UI layout constraints: fixed 900px width (non-compressible) and 78px height; cover left max 35px; title next max 250px; hide alternate titles",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Global UI theme update: black backgrounds for all surfaces (backgrounds/dropdowns/popups) with gold outline + glowing gold watchlist outline",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Make Add Manga popup/dialog scrollable so bottom actions (Add Manga/Cancel) are accessible",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Fix Add Manga button overlap/unclickable behavior (z-index/layout) and ensure form submission works reliably",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Harden backend connectivity: prevent any backend calls until authenticated actor is initialized; improve handling of 'actor not available' / failed-to-connect errors (loading/disable actions/retry)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Implement a backend readiness endpoint that is safe to call without authentication, so the frontend can verify the canister is reachable before issuing any authenticated queries or mutations.",
      "reqIds": [
        "REQ-1"
      ],
      "status": "pending"
    }
  ],
  "architectural_notes": [
    "Backend is implemented in Motoko with modular authorization (MixinAuthorization/access-control) and blob storage (Mixin/Storage).",
    "Frontend is a React + Vite + Tailwind app using shadcn/ui component library.",
    "Frontend uses generated canister bindings (backend.did) and an actor hook pattern (useActor/useInternetIdentity) for authenticated calls.",
    "Assets include generated placeholders (app logo and cover placeholder) produced by build-template image scripts.",
    "Authorization and blob-storage Motoko modules updated/aligned to component versions v4.0.0 (internal refactors/updates across backend main + mixins).",
    "Build-template refreshed (Dockerfile/scripts/workspace configs) and frontend template dependencies/configs updated (React+Vite+Tailwind+shadcn/ui template sync).",
    "Frontend actor initialization now includes retry logic via a dedicated hook (useActorWithRetry) to improve resilience of authenticated calls.",
    "Build-template React frontend was synced/refreshed to the latest template baseline, including expanded shadcn/ui component set and updated tooling/config (Vite/Tailwind/TS).",
    "Build-template now includes custom ESLint rules to enforce Internet Identity provider usage and prevent BigInt usage in query keys.",
    "Guard all canister calls behind confirmed authenticated actor readiness (block/disable UI actions until actor initialized; optionally add retry/backoff + user-visible loading state)."
  ],
  "known_issues": [
    "Intermittent 'actor not available' / failed-to-connect-to-backend errors due to actor initialization race conditions after deployment.",
    "Add Manga UI can become overlapped/unclickable (likely z-index/layout), preventing form submission.",
    "Add Manga dialog content can exceed viewport, hiding action buttons without scroll."
  ],
  "isFixRequest": true,
  "generatedImages": [
    {
      "filename": "frontend/public/assets/generated/app-logo.dim_512x512.png",
      "description": "Generated app logo placeholder image.",
      "targetWidth": 512,
      "targetHeight": 512
    },
    {
      "filename": "frontend/public/assets/generated/cover-placeholder.dim_600x900.png",
      "description": "Generated cover placeholder image.",
      "targetWidth": 600,
      "targetHeight": 900
    }
  ],
  "projectName": "Harden backend connectivity and actor readiness to prevent premature calls",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}